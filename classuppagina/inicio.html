<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calendario Social</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fdf6e3; /* beige claro */
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 700px;
      margin: auto;
      padding: 20px;
    }
    .profile-card {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: #fff8e1;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .profile-pic {
      border-radius: 50%;
      width: 70px;
      height: 70px;
      object-fit: cover;
    }
    .calendar-section h3 {
      margin-top: 25px;
      color: #5a4635;
    }
    .post {
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-bottom: 15px;
    }
    .post-header {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }
    .avatar {
      border-radius: 50%;
    }
    .event-btn {
      background: #d4a373;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px 0;
      transition: 0.2s;
    }
    .event-btn:hover {
      background: #b07d52;
    }
    .divider {
      margin: 20px 0;
    }
    .empty-msg {
      text-align: center;
      color: gray;
      margin: 20px 0;
    }

    /* Calendario */
    #calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #fff3cd;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
    }
    #calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-bottom: 10px;
    }
    .day {
      background: #fff;
      padding: 10px;
      text-align: center;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.2s;
    }
    .day:hover {
      background: #f0e1c6;
    }
    .today {
      background: #d4a373;
      color: white;
    }
    #event-form {
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: #fff8e6;
      padding: 15px;
      border-radius: 10px;
    }
    #event-form input, #event-form button {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    #event-form button {
      background: #d4a373;
      color: white;
      border: none;
      cursor: pointer;
    }
    #event-form button:hover {
      background: #b07d52;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <!-- Encabezado -->
    <header class="profile-section">
      <div class="profile-card">
  <img id="foto-perfil-inicio" src="https://via.placeholder.com/100" alt="fotoPerfil" class="profile-pic">
        <div class="profile-info">
          <h2>Mi Calendario Social</h2>
        </div>
      </div>
    </header>

    <!-- Bot√≥n para agregar recordatorio -->
    <section class="calendar-section">
      <h3>Recordatorios recientes</h3>
      <button class="event-btn" onclick="toggleCalendario()">‚ûï Nuevo recordatorio</button>
      
      <!-- Calendario oculto -->
      <div id="calendarioContainer" style="display:none; margin-top:15px;">
        <div id="calendar-header">
          <button id="prev-month"><--</button>
          <h2 id="month-year"></h2>
          <button id="next-month">--></button>
        </div>
        <div id="calendar"></div>
        <div id="event-form">
          <input type="text" id="event-title" placeholder="T√≠tulo del evento">
          <input type="date" id="event-date">
          <input type="time" id="event-time">
          <input type="text" id="event-desc" placeholder="Descripci√≥n (opcional)">
          <button id="add-event">Agregar evento</button>
        </div>
      </div>

      <!-- Contenedor de publicaciones -->
      <div id="postsContainer">
        <p class="empty-msg">Todav√≠a no hay recordatorios üì≠</p>
      </div>
    </section>
      
    <!-- Men√∫ de navegaci√≥n -->
    <hr class="divider">
    <nav class="calendar-section">
      <div style="display: flex; justify-content: space-around; margin-top: 15px;">
        <a href="busqueda.html" class="event-btn">üîç Buscar</a>
        <a href="perfil.html" class="event-btn">üë§ Perfil</a>
        <a href="amigos.html" class="event-btn">üë• Amigos</a>
        <a href="configuracion.html" class="event-btn">‚öôÔ∏è Ajustes</a>
      </div>
    </nav>

  </div>

  <script>
    const calendarioContainer = document.getElementById("calendarioContainer");
    const postsContainer = document.getElementById("postsContainer");

    function toggleCalendario() {
      calendarioContainer.style.display = 
        calendarioContainer.style.display === "none" ? "block" : "none";
      renderCalendar();
    }

    // --- L√≥gica de calendario ---
    const calendar = document.getElementById("calendar");
    const monthYear = document.getElementById("month-year");
    let currentDate = new Date();

    function renderCalendar() {
      calendar.innerHTML = "";
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      const firstDay = new Date(year, month, 1).getDay();
      const lastDate = new Date(year, month + 1, 0).getDate();
      const today = new Date();

      const months = ["Enero","Febrero","Marzo","Abril","Mayo","Junio",
                      "Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
      monthYear.textContent = `${months[month]} ${year}`;

      // D√≠as vac√≠os al inicio
      for (let i = 0; i < (firstDay === 0 ? 6 : firstDay - 1); i++) {
        const empty = document.createElement("div");
        calendar.appendChild(empty);
      }

      // D√≠as del mes
      for (let d = 1; d <= lastDate; d++) {
        const day = document.createElement("div");
        day.textContent = d;
        day.classList.add("day");
        if (d === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
          day.classList.add("today");
        }
        calendar.appendChild(day);
      }
    }

    document.getElementById("prev-month").onclick = () => {
      currentDate.setMonth(currentDate.getMonth() - 1);
      renderCalendar();
    };
    document.getElementById("next-month").onclick = () => {
      currentDate.setMonth(currentDate.getMonth() + 1);
      renderCalendar();
    };

    // --- Publicar evento ---
    document.getElementById("add-event").onclick = () => {
      const title = document.getElementById("event-title").value;
      const date = document.getElementById("event-date").value;
      const time = document.getElementById("event-time").value;
      const desc = document.getElementById("event-desc").value;

      if (!title || !date) {
        alert("Completa al menos t√≠tulo y fecha.");
        return;
      }

      const emptyMsg = postsContainer.querySelector(".empty-msg");
      if (emptyMsg) emptyMsg.remove();

      const post = document.createElement("div");
      post.classList.add("post");
      post.innerHTML = `
        <div class="post-header">
          <img src="https://via.placeholder.com/50" class="avatar" alt="avatar">
          <div>
            <strong>${title}</strong>
            <p class="post-date">üìÖ ${date} ‚è∞ ${time || "Sin hora"}</p>
          </div>
        </div>
        <div class="post-content">
          <p>${desc || "Sin descripci√≥n"}</p>
        </div>
      `;
      postsContainer.prepend(post);

      // Resetear form
      document.getElementById("event-title").value = "";
      document.getElementById("event-date").value = "";
      document.getElementById("event-time").value = "";
      document.getElementById("event-desc").value = "";
      calendarioContainer.style.display = "none";
    };

    // Mostrar foto de perfil en el encabezado si existe en localStorage
    const fotoPerfil = localStorage.getItem('fotoPerfil');
    if (fotoPerfil) {
      document.getElementById('foto-perfil-inicio').src = fotoPerfil;
    }

    // Funci√≥n para obtener la foto de perfil para los avatares
    function getAvatarSrc() {
      return localStorage.getItem('fotoPerfil') || 'https://via.placeholder.com/50';
    }

    // Modificar la funci√≥n de agregar evento para usar la foto de perfil como avatar
    const originalAddEvent = document.getElementById("add-event").onclick;
    document.getElementById("add-event").onclick = () => {
      const title = document.getElementById("event-title").value;
      const date = document.getElementById("event-date").value;
      const time = document.getElementById("event-time").value;
      const desc = document.getElementById("event-desc").value;

      if (!title || !date) {
        alert("Completa al menos t√≠tulo y fecha.");
        return;
      }

      const emptyMsg = postsContainer.querySelector(".empty-msg");
      if (emptyMsg) emptyMsg.remove();

      const post = document.createElement("div");
      post.classList.add("post");
      post.innerHTML = `
        <div class="post-header">
          <img src="${getAvatarSrc()}" class="avatar" alt="avatar">
          <div>
            <strong>${title}</strong>
            <p class="post-date">üìÖ ${date} ‚è∞ ${time || "Sin hora"}</p>
          </div>
        </div>
        <div class="post-content">
          <p>${desc || "Sin descripci√≥n"}</p>
        </div>
      `;
      postsContainer.prepend(post);

      // Resetear form
      document.getElementById("event-title").value = "";
      document.getElementById("event-date").value = "";
      document.getElementById("event-time").value = "";
      document.getElementById("event-desc").value = "";
      calendarioContainer.style.display = "none";
    };

    renderCalendar();
  </script>
</body>
</html>
